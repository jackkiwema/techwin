<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        <title>TechWin</title>
    </head>
    <body>
    <h2 class="display-2 text-center">TechWin</h2>
    <hr class="dropdown-divider">
    <div>
    <form name="submit-to-google-sheet">

    <label for="Name" class="form-label">Name</label><br>
    <input name="Name" type="text" placeholder="Name" class="form-control" autocomplete="off" autofocus required><br><br>

    <label for="Product" class="form-label">Product</label><br>
    <input name="Product" type="text" placeholder="Product" class="form-control" autocomplete="off" autofocus required><br><br>

    <label for="Contact" class="form-label">Contact</label><br>
    <input name="Contact" type="number" placeholder="Contact" class="form-control" autocomplete="off" autofocus required><br><br>

    <label for="Email" class="form-label">Email</label><br>
    <input name="Email" type="email" placeholder="Email" class="form-control" autocomplete="off" autofocus><br><br>

  <label for="share">Shared With:</label><br>
  <select name="share" class="form-select form-select-sm" aria-label=".form-select-sm example">
    <option value=""></option>
    <option value="Boniface">Boniface</option>
    <option value="Ken">Ken</option>
    <option value="Wanjohi">Wanjohi</option>
    <option value="Alex">Alex</option>
    <option value="Valentine">Valentine</option>
    <option value="Langat">Langat</option>
    <option value="Fred Nguyu">Fred Nguyu</option>
    <option value="Stanley">Stanley</option>
  </select><br><br>  

  <div class="form-floating">
    <textarea name="Notes" rows="6" cols="50" class="form-control mb-3" style="height: 100px"></textarea>
    <label for="Notes">Notes</label>
  </div>

  <button class="btn btn-primary" type="submit">Send</button>
</form>
<span id="msg"></span>
</div>


<script>
const scriptURL = 'https://script.google.com/macros/library/d/1rGMgxAVufX2KKZlPX5I-ZQDRqSw9DhE4xY-4tluEAJ7QN_GuelqVAjb1/1'
const form = document.forms['submit-to-google-sheet']
const msg = document.getElementById("msg")
  
    form.addEventListener('submit', e => {
      e.preventDefault()
      const formData = new FormData(form);
      for (let [key, value] of formData.entries()) {
        console.log(key, value);
    }
    fetch(scriptURL, { method: 'POST', body: formData})
        .then(response => {
            msg.innerHTML = "Message Sent successfully"
            setTimeout(function(){
                msg.innerHTML = ""
            }, 500)
            form.reset()
        }) 
        .catch(error => console.error('Error!', error.message))
    });

</script>
    </body>
</html>